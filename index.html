<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jaspion Design Studio</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

  <!-- TOP TOOLBAR -->
  <header id="top-bar">
    <div class="top-left">
      <div class="logo">
        <span class="logo-icon">◆</span>
        <span class="logo-text">Jaspion <span class="logo-sub">Design Studio</span></span>
      </div>
    </div>
    <div class="top-center">
      <div class="url-bar-group">
        <div class="url-input-wrap">
          <svg class="url-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
          <input id="url-input" type="text" placeholder="Enter URL to review..." spellcheck="false">
          <button id="btn-load-url" title="Load URL">→</button>
        </div>
      </div>
      <div class="preset-group">
        <button class="preset" data-url="https://certificateoftitle.nz">CertNZ</button>
        <button class="preset" data-url="https://titlefinder.com.au">TitleFinder</button>
        <button class="preset" data-url="https://paidmate.com.au">PaidMate</button>
        <button class="preset" data-url="https://ziggysitters.com">Ziggy</button>
        <button class="preset" data-url="https://peaceemergency.com">Peace</button>
      </div>
    </div>
    <div class="top-right">
      <div class="mode-switch">
        <button class="mode-btn" data-tool="browse" title="Browse mode">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"/></svg>
          <span>Browse</span>
        </button>
        <button class="mode-btn active" data-tool="postit" title="Comment mode">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
          <span>Comment</span>
        </button>
      </div>
      <div class="separator"></div>
      <div class="device-toggles">
        <button class="device-btn active" data-w="100%" title="Desktop">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><path d="M8 21h8M12 17v4"/></svg>
        </button>
        <button class="device-btn" data-w="768px" title="Tablet">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="4" y="2" width="16" height="20" rx="2"/><path d="M12 18h.01"/></svg>
        </button>
        <button class="device-btn" data-w="375px" title="Mobile">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="5" y="2" width="14" height="20" rx="2"/><path d="M12 18h.01"/></svg>
        </button>
      </div>
      <div class="separator"></div>
      <div class="tool-group">
        <button class="tool-btn" data-tool="cloud" title="Circle area">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/></svg>
        </button>
        <button class="tool-btn" data-tool="arrow" title="Arrow">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
        </button>
        <button class="tool-btn" data-tool="clear" title="Clear all">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
        </button>
      </div>
      <div class="separator"></div>
      <button id="toggle-sidebar" class="icon-btn" title="Toggle comments panel">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
        <span class="badge" id="ann-badge">0</span>
      </button>
    </div>
  </header>

  <!-- MAIN CONTENT -->
  <div id="workspace">
    <!-- Preview Area -->
    <div id="preview-area">
      <div id="preview-container">
        <div id="device-frame" class="frame-desktop">
          <div class="frame-chrome">
            <div class="chrome-dots"><span></span><span></span><span></span></div>
            <div class="chrome-url" id="chrome-url-display">about:blank</div>
          </div>
          <div id="preview-wrapper">
            <iframe id="preview-iframe" src="about:blank"></iframe>
            <canvas id="annotation-canvas"></canvas>
            <svg id="svg-overlay" xmlns="http://www.w3.org/2000/svg"></svg>
            <div id="postit-layer"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- RIGHT SIDEBAR -->
    <aside id="sidebar" class="open">
      <div class="sidebar-tabs">
        <button class="tab-btn active" data-tab="annotations">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
          Comments <span class="tab-count" id="ann-count-tab">0</span>
        </button>
        <button class="tab-btn" data-tab="chat">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
          Chat
        </button>
      </div>

      <!-- Annotations Tab -->
      <div id="tab-annotations" class="tab-panel active">
        <div id="annotation-list"></div>
        <div class="empty-state" id="empty-annotations">
          <div class="empty-icon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
          </div>
          <h4>No comments yet</h4>
          <p>Click anywhere on the design to leave a comment</p>
        </div>
        <div id="submit-area">
          <button id="btn-export-json" class="btn-export" title="Export as JSON">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/></svg>
            JSON
          </button>
          <button id="btn-export-md" class="btn-export" title="Export as Markdown">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
            MD
          </button>
          <button id="btn-submit" class="btn-submit-main">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
            Send to Jaspion
          </button>
        </div>
      </div>

      <!-- Chat Tab -->
      <div id="tab-chat" class="tab-panel">
        <div id="chat-messages"></div>
        <div class="chat-input-area">
          <textarea id="chat-input" rows="2" placeholder="Message Jaspion..."></textarea>
          <button id="chat-send" title="Send">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
          </button>
        </div>
      </div>
    </aside>
  </div>

  <!-- STATUS BAR -->
  <footer id="status-bar">
    <span id="status-text">Ready — Select a site or enter a URL to begin</span>
    <span id="status-tool">Comment mode</span>
  </footer>

  <!-- Edit Modal -->
  <div id="edit-modal" class="modal-overlay">
    <div class="modal-box">
      <div class="modal-header">
        <h3 id="edit-title">Edit Comment</h3>
        <button class="modal-close" onclick="closeModal()">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <textarea id="edit-text" rows="3" placeholder="What needs to change?"></textarea>
      <div class="modal-row">
        <label>Priority</label>
        <select id="edit-priority">
          <option value="high">High</option>
          <option value="medium" selected>Medium</option>
          <option value="low">Low</option>
        </select>
      </div>
      <div class="modal-row">
        <label>Type</label>
        <select id="edit-type">
          <option value="change">Change</option>
          <option value="bug">Bug</option>
          <option value="add">Add</option>
          <option value="remove">Remove</option>
          <option value="style">Style</option>
        </select>
      </div>
      <div class="modal-actions">
        <button class="btn-save" onclick="saveAnnotation()">Save</button>
        <button class="btn-delete" onclick="deleteAnnotation()">Delete</button>
        <button class="btn-cancel" onclick="closeModal()">Cancel</button>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
